- data = JSON.load(@task.result.file_contents(:original))

%div.center
  %h1= @dataset.name
  %h2 References to proper names

  %div{ data: { role: 'collapsible-set' } }
    - if data['PERSON']
      %div{ data: { role: 'collapsible' } }
        %h3 People
        %ul{ data: { role: 'listview' } }
          - data['PERSON'].uniq.sort.each do |p|
            %li= link_to p, "https://en.wikipedia.org/w/index.php?title=Special:Search&search=#{CGI.escape(p)}&fulltext=Search", rel: 'external'
    - if data['ORGANIZATION']
      %div{ data: { role: 'collapsible' } }
        %h3 Organizations
        %ul{ data: { role: 'listview' } }
          - data['ORGANIZATION'].uniq.sort.each do |o|
            %li= link_to o, "https://en.wikipedia.org/w/index.php?title=Special:Search&search=#{CGI.escape(o)}&fulltext=Search", rel: 'external'
    - if data['LOCATION']
      %div.named_entities_map_collapsible{ data: { role: 'collapsible' } }
        %h3 Locations (Map)
        %div.named_entities_map_data= data['LOCATION'].uniq.sort.to_json
        %div.named_entities_map
      %div{ data: { role: 'collapsible' } }
        %h3 Locations (List)
        %ul{ data: { role: 'listview' } }
          - data['LOCATION'].uniq.sort.each do |l|
            %li= link_to l, "https://en.wikipedia.org/w/index.php?title=Special:Search&search=#{CGI.escape(l)}&fulltext=Search", rel: 'external'
    - unless data.reject { |c| %w{PERSON ORGANIZATION LOCATION}.include?(c) }.empty?
      %div{ data: { role: 'collapsible' } }
        %h3 Other
        %ul{ data: { role: 'listview' } }
          - data.reject { |c| %w{PERSON ORGANIZATION LOCATION}.include?(c) }.each do |c|
            %li{ data: { role: 'list-divider' } }= c
            - c.uniq.sort.each do |o|
              %li= link_to o, "https://en.wikipedia.org/w/index.php?title=Special:Search&search=#{CGI.escape(o)}&fulltext=Search", rel: 'external'

  = link_to 'Download in CSV format', { controller: 'datasets', action: 'task_view', id: @dataset.to_param, task_id: @task.to_param, view: 'download', format: 'csv' }, rel: 'external', data: { role: 'button', icon: 'bars', inline: 'true' }
