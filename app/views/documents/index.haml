- if params[:q] or params[:fq] or params[:precise]
  - title "Search Results"

%div.leftcolumn
  %ul.columnul{ 'data-role' => 'listview', 'data-theme' => 'd' }
    %li.list-searchbar{ 'data-theme' => 'c' }
      = render :partial => "layouts/searchbar"
    - if @documents.length == 0
      %li{ 'data-icon' => 'warning', 'data-theme' => 'e' }
        %h3 No Documents Found
        %p
          Your search produced no results.
    - else
      %li{ 'data-theme' => 'c' }
        == #{pluralize(@documents.length, 'document')}
        - if params[:q] or params[:fq] or params[:precise]
          found
        - else
          in database
      - for doc in @documents
        %li{ 'data-icon' => 'info' }
          = link_to document_path(doc), 'data-ajax' => 'false' do
            = render :partial => "cite", :locals => { :document => doc }
      - if @documents.total_pages > 1
        %li= will_paginate @documents
      %li{ :class => 'small-li', 'data-theme' => 'c' }= link_to "Export/download these citations", formats_document_export_path(@documents)
  
  %div.verticalpad

%div.rightcolumn
  %ul.facet-list.columnul{ 'data-role' => 'listview', 'data-theme' => 'd', 'data-dividertheme' => 'c' }
    %li{ 'data-theme' => 'c' } Filter results:
    - rendered_facets = 0
    - unless params[:fq].blank?
      %li{ 'data-role' => 'list-divider' } Selected Filters
      = render_selected_facets(params)
      - rendered_facets += 1
    - get_facets.each do |facet|
      - content = render_solr_facet(params, facet, @facets[facet[:key]])
      - next if content.blank?
      - rendered_facets += 1
      
      %li{ 'data-role' => 'list-divider' }== Filter: #{facet[:name]}
      = content
    
    - if rendered_facets == 0
      %li{ 'data-role' => 'list-divider' } No Filters Available

    %li{ 'data-role' => 'list-divider', 'data-icon' => 'search', 'data-theme' => 'c' }
      = link_to 'Advanced Search...', search_documents_path

- content_for :javascripts do
  = javascript_include_tag "collapse_list"