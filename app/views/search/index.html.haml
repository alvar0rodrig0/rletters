- content_for :head_tags do
  %link{ rel: 'unapi-server', type: 'application/xml', title: 'unAPI', href: unapi_url }/
- content_for :breadcrumbs do
  %li= link_to t('breadcrumbs.root'), root_path
  - if user_signed_in? && current_user.workflow_active
    %li= link_to t('breadcrumbs.workflow_start'), workflow_start_path
    %li= link_to t('breadcrumbs.workflow_info'), workflow_info_path(current_user.workflow_class)
    %li= link_to t('breadcrumbs.workflow_activate'), workflow_activate_path(current_user.workflow_class)
  %li.active= t('breadcrumbs.search_index')

.row
  .col-sm-12
    &nbsp;
.row
  .col-sm-12.col-lg-9
    .row
      = form_tag(search_path, method: :get, id: 'search_form', role: 'form') do
        - if result.params['fq']
          - [result.params['fq']].flatten.each do |p|
            = hidden_field_tag "fq[]", p
        .col-sm-8
          .form-group
            %label.sr-only{ for: 'q' }= t('.placeholder')
            = search_field_tag :q, (params[:precise] ? t('.adv_search_placeholder') : params[:q]), placeholder: t('.placeholder'), class: 'form-control'

        .col-sm-4
          .btn-group.btn-group-justified
            .btn-group
              = link_to('#', class: 'btn btn-default dropdown-toggle', 'data-toggle' => 'dropdown') do
                = t('.sort')
                %span.caret
              %ul.dropdown-menu{ role: 'menu' }
                - result.sort_methods.each do |(param, desc)|
                  %li
                    = link_to search_path(params.merge({ sort: param })) do
                      %span{ style: (param == result.params['sort'] ? nil : 'visibility: hidden') } &check;
                      = desc

            .btn-group
              - if user_signed_in?
                = link_to t('.create_dataset'), new_dataset_path(q: result.params['q'], def_type: result.params['defType'], fq: result.params['fq']), class: 'btn btn-success'
              - else
                %button{ type: 'button', class: 'btn btn-success', disabled: 'disabled' }= t('.create_dataset')

.row
  .col-sm-12.col-lg-9
    .navbar.navbar-default{ role: 'navigation' }
      .container-fluid
        .navbar-left
          %p.navbar-text= result.num_hits
          -# = result.filter_removal_links

    %ul.pagination{ style: 'text-align: center' }= result.pagination

    %table.table.table-striped
      - result.documents.each do |d|
        %tr
          %td{ 'data-dropdown' => "drop-#{d.uid.html_id}" }
            %abbr{ class: 'unapi-id', title: d.uid }= ''
            = d.citation
    .pagination-centered= result.pagination

    - result.documents.each do |d|
      %div.f-dropdown.medium.content{ 'data-dropdown-content' => true, id: "drop-#{d.uid.html_id}" }= render partial: 'dropdown', locals: { document: d }

  .small-12.large-3.columns
    .panel
      %h5= t('.filters')
      %ul.side-nav
        - if result.facets
          = result.facets.addition_links
        %li.divider
        - if result.categories
          = result.categories.link_tree

      %p= link_to t('.advanced_search'), search_advanced_path, class: 'button secondary small expand'
