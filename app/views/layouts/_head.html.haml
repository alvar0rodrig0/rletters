%head
  %meta{ :charset => "utf-8" }/
  
  - title = APP_CONFIG['app_name'].dup
  - title << " - #{yield(:title)}" if content_for? :title
  %title= title
  
  %meta{ :content => APP_CONFIG['app_description'], :name => "description" }/
  %meta{ :content => APP_CONFIG['app_author'], :name => "author" }/
  
  -# Mobile optimized meta tags for various browsers
  %meta{ :name => 'HandheldFriendly', :content => 'True' }/
  %meta{ :name => 'MobileOptimized', :content => 320 }/
  %meta{ :name => 'viewport', :content => "width=device-width, initial-scale=1.0, maximum-scale=1.0" }/
  %meta{ 'http-equiv' => 'cleartype', :content => 'on' }/
  
  -# Act like a web app on iOS
  %meta{ :name => 'apple-mobile-web-app-capable', :content => 'yes' }/
  %meta{ :name => 'apple-mobile-web-app-status-bar-style', :content => 'black' }/
  %link{ :href => 'images/l/splash.png', :rel => 'apple-touch-startup-image' }/
  
  -# Home screen icons (Retina iPhone, iPad, all others/Android)
  %link{ :href => "/images/h/apple-touch-icon.png", :rel => "apple-touch-icon-precomposed", :sizes => "114x114" }/
  %link{ :href => "/images/m/apple-touch-icon.png", :rel => "apple-touch-icon-precomposed", :sizes => "72x72" }/
  %link{ :href => "/images/l/apple-touch-icon.png", :rel => "apple-touch-icon-precomposed" }/
  %link{ :href => "/favicon.ico", :rel => "shortcut icon" }/
  
  -# Javascript: Rails + jQuery + jQM
  = javascript_include_tag "application"
  = javascript_include_tag "http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.js"
  
  -# CSS: Application + jQM
  = stylesheet_link_tag 'application', :media => 'all'  
  = stylesheet_link_tag "http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.css"
  
  -# Link up the unAPI service
  %link{ :rel => 'unapi-server', :type => 'application/xml', :title => 'unAPI', :href => unapi_url }
  
  -# Google Analytics for jQM
  :javascript
    var _gaq=[['_setAccount','#{APP_CONFIG['google_account_id']}'],['_trackPageview']];(function(d,t){
    var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.async=1;g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)
    }(document,'script'))
  
  :javascript
    $('[data-role=page]').live('pageshow', function (event, ui) {
      try {
        if (location.hash){url = location.hash;}else{url='index';}
        _gaq.push(['_trackPageview',url]);
      } catch (error) {}
    });
  
  = csrf_meta_tag
